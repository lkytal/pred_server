"use strict";var mono={G:57.021464,A:71.037114,S:87.032029,P:97.052764,V:99.068414,T:101.04768,C:160.03019,L:113.08406,I:113.08406,D:115.02694,Q:128.05858,K:128.09496,E:129.04259,M:131.04048,m:147.0354,H:137.05891,F:147.06441,R:156.10111,Y:163.06333,N:114.04293,W:186.07931,O:147.03538},ave={A:71.0788,R:156.1875,N:114.1038,D:115.0886,C:160.1598,E:129.1155,Q:128.1307,G:57.0519,H:137.1411,I:113.1594,L:113.1594,K:128.1741,M:131.1926,F:147.1766,P:97.1167,S:87.0782,T:101.1051,W:186.2132,Y:163.176,V:99.1326},charMap={A:1,R:2,N:3,D:3,C:5,E:5,Q:7,G:8,H:9,I:10,L:11,K:12,M:13,F:14,P:15,S:16,T:17,W:18,Y:19,V:20},max_len=22,max_in=24,x_dim=25,mass_scale=2e3;function fastmass(a){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,r=0,t=!0,e=!1,n=void 0;try{for(var m,i=a[Symbol.iterator]();!(t=(m=i.next()).done);t=!0){var o=m.value;r+=mono[o]}}catch(a){e=!0,n=a}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}return(r+1.008*s)/s}function matrix(a,s){for(var r=new Array,t=0;t<a;t++){r[t]=new Array;for(var e=0;e<s;e++)r[t][e]=0}return r}function embed(a,s,r){r=r.toUpperCase(),a=parseInt(a),s=parseInt(s);var t=matrix(max_in,x_dim),e=t[t.length-1];if(r.length>max_len)return!1;t[r.length][21]=1;for(var n=r.length+1;n<max_in;n++)t[n][0]=1;e[0]=fastmass(r,ion_type="M",s=1)/mass_scale,e[s]=1,e[5+a]=1,e[9]=.25,mass1c=fastmass(r,ion_type="M",s=1);for(var m=0;m<r.length;m++)t[m][charMap[r[m]]]=1,t[m][x_dim-1]=mono[r[m]],b_mass=fastmass(r.slice(0,m),ion_type="b",s=1),t[m][x_dim-2]=b_mass/mass_scale,t[m][x_dim-3]=(mass1c-b_mass+1.00794)/mass_scale;return t}Array.prototype.at=function(a){return a<0?this[this.length+a]:this[a]},exports.embed=embed,exports.fastmass=fastmass;