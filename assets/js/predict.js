"use strict";function _slicedToArray(n,t){return _arrayWithHoles(n)||_iterableToArrayLimit(n,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(n,t){var o=[],e=!0,r=!1,i=void 0;try{for(var l,a=n[Symbol.iterator]();!(e=(l=a.next()).done)&&(o.push(l.value),!t||o.length!==t);e=!0);}catch(n){r=!0,i=n}finally{try{e||null==a.return||a.return()}finally{if(r)throw i}}return o}function _arrayWithHoles(n){if(Array.isArray(n))return n}function init(){$("#info, #loadding, #loadErr, #invalid, #plot, #mgf").removeClass("hidden").slideUp(0),$("select").select2({dropdownCssClass:"dropdown-inverse"}),$(".input-group").on("focus",".form-control",function(){return $(this).closest(".input-group, .form-group").addClass("focus")}).on("blur",".form-control",function(){return $(this).closest(".input-group, .form-group").removeClass("focus")}),$(".btn-group").on("click","a",function(){return $(this).siblings().removeClass("active").end().addClass("active")})}function mgf(n,t,o,e,r,i){for(var l="BEGIN IONS\nTitle=".concat(o,"\nCHARGE=").concat(t,"+\nPEPMASS=").concat(e,"\n"),a=0;a<r.length;a++)l+=r[a].toFixed(2)+"\t"+i[a].toFixed(5)+"\n";return l+"END IONS"}function show_result(n,t,o,e){var r=_slicedToArray(n,3),i=r[0],l=r[1],a=r[2];$("#mgf_box").html(mgf(t,o,e,i,l,a)),$("#rst").html('<div id="sp"></div>'),Plotly.newPlot("sp",[{x:l,y:a,type:"bar"}],{title:{text:"Prediction of ".concat(e,", charge ").concat(o,"+, ").concat(t)},xaxis:{range:[130,l[l.length-1]+50],title:{text:"M/z"}}})}function get(t,o,e){jQuery.getJSON("/json/".concat(t,"/").concat(o,"/").concat(e,"?id=").concat((new Date).valueOf()),function(n){$("#loadding").slideUp(400),$("#info").slideDown(400),$("#plot").slideDown(400),$("#mgf").slideDown(400),setTimeout(function(){$("#info").slideUp(400)},1500),$("body, html").animate({scrollTop:$("#info")[0].offsetTop-300},1e3),show_result(n,t,o,e)}).fail(function(n){$("#loadding").slideUp(400),$("#loadErr").slideDown(400)})}var charMap={A:1,R:2,N:3,D:3,C:5,E:5,Q:7,G:8,H:9,I:10,L:11,K:12,M:13,F:14,P:15,S:16,T:17,W:18,Y:19,V:20};function invalid(n){if(22<(n=n.toUpperCase()).length)return!0;var t=!0,o=!1,e=void 0;try{for(var r,i=n[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var l=r.value;if(!charMap.hasOwnProperty(l))return!0}}catch(n){o=!0,e=n}finally{try{t||null==i.return||i.return()}finally{if(o)throw e}}return!1}function doSearch(){if(invalid($("#peptide").val()))return $("#info").slideUp(400),$("#loadding").slideUp(400),$("#loadErr").slideUp(400),void $("#invalid").slideDown(400);$("#info").slideUp(400),$("#loadErr").slideUp(400),$("#invalid").slideUp(400),$("#plot").slideUp(400),$("#mgf").slideUp(400),$("#loadding").slideDown(400),get($("#type").val(),$("#charge").val(),$("#peptide").val().toUpperCase())}init(),$("#search").on("click",function(n){return doSearch()}),$("#peptide").focus().on("keydown",function(n){if(13===n.which)return doSearch()});