"use strict";function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(r){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r))return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r)){for(var t=0,a=new Array(r.length);t<r.length;t++)a[t]=r[t];return a}}var mono={G:57.021464,A:71.037114,S:87.032029,P:97.052764,V:99.068414,T:101.04768,C:160.03019,L:113.08406,I:113.08406,D:115.02694,Q:128.05858,K:128.09496,E:129.04259,M:131.04048,m:147.0354,H:137.05891,F:147.06441,R:156.10111,Y:163.06333,N:114.04293,W:186.07931,O:147.03538},ave={A:71.0788,R:156.1875,N:114.1038,D:115.0886,C:160.1598,E:129.1155,Q:128.1307,G:57.0519,H:137.1411,I:113.1594,L:113.1594,K:128.1741,M:131.1926,F:147.1766,P:97.1167,S:87.0782,T:101.1051,W:186.2132,Y:163.176,V:99.1326},charMap={A:1,R:2,N:3,D:3,C:5,E:5,Q:7,G:8,H:9,I:10,L:11,K:12,M:13,F:14,P:15,S:16,T:17,W:18,Y:19,V:20},max_len=22,max_in=24,x_dim=25,mass_scale=2e3;function fastmass(r){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,a=0,e=!0,n=!1,o=void 0;try{for(var s,i=r[Symbol.iterator]();!(e=(s=i.next()).done);e=!0){var l=s.value;a+=mono[l]}}catch(r){n=!0,o=r}finally{try{e||null==i.return||i.return()}finally{if(n)throw o}}return(a+1.008*t)/t}function matrix(r,t){for(var a=new Array,e=0;e<r;e++){a[e]=new Array;for(var n=0;n<t;n++)a[e][n]=0}return a}function embed(r,t,a){a=a.toUpperCase(),r=parseInt(r),t=parseInt(t);var e=matrix(max_in,x_dim),n=e[e.length-1];if(a.length>max_len)return!1;e[a.length][21]=1;for(var o=a.length+1;o<max_in;o++)e[o][0]=1;n[0]=fastmass(a,ion_type="M",t=1)/mass_scale,n[t]=1,n[5+r]=1,n[9]=.25,mass1c=fastmass(a,ion_type="M",t=1);for(var s=0;s<a.length;s++)e[s][charMap[a[s]]]=1,e[s][x_dim-1]=mono[a[s]],b_mass=fastmass(a.slice(0,s),ion_type="b",t=1),e[s][x_dim-2]=b_mass/mass_scale,e[s][x_dim-3]=(mass1c-b_mass+1.00794)/mass_scale;return e}function filter(r){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:180,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.2,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1e-4,n=Math.max.apply(Math,_toConsumableArray(r));r=r.map(function(r){return r/n^4});for(var o=[],s=[],i=0;i<r.length;i++)r[i]>e&&(o.push(t+a*i),s.push(r[i]));return[o,s]}Array.prototype.at=function(r){return r<0?this[this.length+r]:this[r]},exports.filter=filter,exports.embed=embed,exports.fastmass=fastmass;